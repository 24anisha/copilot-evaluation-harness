{
    "case_id": "case-2251",
    "repo_name": "newbee-ltd/newbee-mall",
    "file_path": "src/main/java/ltd/newbee/mall/service/impl/NewBeeMallOrderServiceImpl.java",
    "line_range": [
        350,
        371
    ],
    "command_specific_fields": {
        "method_name": "finishOrder"
    },
    "language": "java",
    "commit": "613a662adf1da7623ec34459bc83e3c1b12d8ce7",
    "code_snippet": "    @Override\n    public String finishOrder(String orderNo, Long userId) {\n        NewBeeMallOrder newBeeMallOrder = newBeeMallOrderMapper.selectByOrderNo(orderNo);\n        if (newBeeMallOrder != null) {\n            //\u9a8c\u8bc1\u662f\u5426\u662f\u5f53\u524duserId\u4e0b\u7684\u8ba2\u5355\uff0c\u5426\u5219\u62a5\u9519\n            if (!userId.equals(newBeeMallOrder.getUserId())) {\n                return ServiceResultEnum.NO_PERMISSION_ERROR.getResult();\n            }\n            //\u8ba2\u5355\u72b6\u6001\u5224\u65ad \u975e\u51fa\u5e93\u72b6\u6001\u4e0b\u4e0d\u8fdb\u884c\u4fee\u6539\u64cd\u4f5c\n            if (newBeeMallOrder.getOrderStatus().intValue() != NewBeeMallOrderStatusEnum.ORDER_EXPRESS.getOrderStatus()) {\n                return ServiceResultEnum.ORDER_STATUS_ERROR.getResult();\n            }\n            newBeeMallOrder.setOrderStatus((byte) NewBeeMallOrderStatusEnum.ORDER_SUCCESS.getOrderStatus());\n            newBeeMallOrder.setUpdateTime(new Date());\n            if (newBeeMallOrderMapper.updateByPrimaryKeySelective(newBeeMallOrder) > 0) {\n                return ServiceResultEnum.SUCCESS.getResult();\n            } else {\n                return ServiceResultEnum.DB_ERROR.getResult();\n            }\n        }\n        return ServiceResultEnum.ORDER_NOT_EXIST_ERROR.getResult();\n    }\n"
}