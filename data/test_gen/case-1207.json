{
    "case_id": "case-1207",
    "repo_name": "Zulko/moviepy",
    "file_path": "moviepy/video/fx/headblur.py",
    "code_snippet": "    The position of the blur at time t is defined by (fx(t), fy(t)), the radius\n    of the blurring by ``radius`` and the intensity of the blurring by ``intensity``.\n    \"\"\"\n\n    fx: callable\n    fy: callable\n    radius: float\n    intensity: float = None\n\n    def apply(self, clip: Clip) -> Clip:\n        \"\"\"Apply the effect to the clip.\"\"\"\n        if self.intensity is None:\n            self.intensity = int(2 * self.radius / 3)\n\n        def filter(gf, t):\n            im = gf(t).copy()\n            h, w, d = im.shape\n            x, y = int(self.fx(t)), int(self.fy(t))\n            x1, x2 = max(0, x - self.radius), min(x + self.radius, w)\n            y1, y2 = max(0, y - self.radius), min(y + self.radius, h)\n\n            image = Image.fromarray(im)\n            mask = Image.new(\"RGB\", image.size)\n            draw = ImageDraw.Draw(mask)\n            draw.ellipse([x1, y1, x2, y2], fill=(255, 255, 255))\n\n            blurred = image.filter(ImageFilter.GaussianBlur(radius=self.intensity))\n\n            res = np.where(np.array(mask) > 0, np.array(blurred), np.array(image))\n            return res\n\n        return clip.transform(filter)\n",
    "line_range": [
        14,
        46
    ],
    "command_specific_fields": {
        "method_name": "headblur"
    },
    "language": "python",
    "commit": "0f6f6d4d9b96c69d109975549fe6293931f1a19d",
    "prompt": ""
}