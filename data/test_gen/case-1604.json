{
    "case_id": "case-1604",
    "repo_name": "wkentaro/labelme",
    "file_path": "labelme/app.py",
    "code_snippet": "            item.setCheckState(Qt.Checked if flag else Qt.Unchecked)\n\n\n\n    def loadFile(self, filename=None):\n\n        \"\"\"Load the specified file, or the last opened file if None.\"\"\"\n\n        # changing fileListWidget loads file\n\n        if filename in self.imageList and (\n\n            self.fileListWidget.currentRow() != self.imageList.index(filename)\n\n        ):\n\n            self.fileListWidget.setCurrentRow(self.imageList.index(filename))\n\n            self.fileListWidget.repaint()\n\n            return\n\n\n\n        self.resetState()\n\n        self.canvas.setEnabled(False)\n\n        if filename is None:\n\n            filename = self.settings.value(\"filename\", \"\")\n\n        filename = str(filename)\n\n        if not QtCore.QFile.exists(filename):\n\n            self.errorMessage(\n\n                self.tr(\"Error opening file\"),\n\n                self.tr(\"No such file: <b>%s</b>\") % filename,\n\n            )\n\n            return False\n\n        # assumes same name, but json extension\n\n        self.status(str(self.tr(\"Loading %s...\")) % osp.basename(str(filename)))\n\n        label_file = osp.splitext(filename)[0] + \".json\"\n\n        if self.output_dir:\n\n            label_file_without_path = osp.basename(label_file)\n\n            label_file = osp.join(self.output_dir, label_file_without_path)\n\n        if QtCore.QFile.exists(label_file) and LabelFile.is_label_file(label_file):\n\n            try:\n\n                self.labelFile = LabelFile(label_file)\n\n            except LabelFileError as e:\n\n                self.errorMessage(\n\n                    self.tr(\"Error opening file\"),\n\n                    self.tr(\n\n                        \"<p><b>%s</b></p>\"\n\n                        \"<p>Make sure <i>%s</i> is a valid label file.\"\n\n                    )\n\n                    % (e, label_file),\n\n                )\n\n                self.status(self.tr(\"Error reading %s\") % label_file)\n\n                return False\n\n            self.imageData = self.labelFile.imageData\n\n            self.imagePath = osp.join(\n\n                osp.dirname(label_file),\n\n                self.labelFile.imagePath,\n\n            )\n\n            self.otherData = self.labelFile.otherData\n\n        else:\n\n            self.imageData = LabelFile.load_image_file(filename)\n\n            if self.imageData:\n\n                self.imagePath = filename\n\n            self.labelFile = None\n\n        image = QtGui.QImage.fromData(self.imageData)\n\n\n\n        if image.isNull():\n\n            formats = [\n\n                \"*.{}\".format(fmt.data().decode())\n\n                for fmt in QtGui.QImageReader.supportedImageFormats()\n\n            ]\n\n            self.errorMessage(\n\n                self.tr(\"Error opening file\"),\n\n                self.tr(\n\n                    \"<p>Make sure <i>{0}</i> is a valid image file.<br/>\"\n\n                    \"Supported image formats: {1}</p>\"\n\n                ).format(filename, \",\".join(formats)),\n\n            )\n\n            self.status(self.tr(\"Error reading %s\") % filename)\n\n            return False\n\n        self.image = image\n\n        self.filename = filename\n\n        if self._config[\"keep_prev\"]:\n\n            prev_shapes = self.canvas.shapes\n\n        self.canvas.loadPixmap(QtGui.QPixmap.fromImage(image))\n\n        flags = {k: False for k in self._config[\"flags\"] or []}\n\n        if self.labelFile:\n\n            self.loadLabels(self.labelFile.shapes)\n\n            if self.labelFile.flags is not None:\n\n                flags.update(self.labelFile.flags)\n\n        self.loadFlags(flags)\n\n        if self._config[\"keep_prev\"] and self.noShapes():\n\n            self.loadShapes(prev_shapes, replace=False)\n\n            self.setDirty()\n\n        else:\n\n            self.setClean()\n\n        self.canvas.setEnabled(True)\n\n        # set zoom values\n\n        is_initial_load = not self.zoom_values\n\n        if self.filename in self.zoom_values:\n\n            self.zoomMode = self.zoom_values[self.filename][0]\n\n            self.setZoom(self.zoom_values[self.filename][1])\n\n        elif is_initial_load or not self._config[\"keep_prev_scale\"]:\n\n            self.adjustScale(initial=True)\n\n        # set scroll values\n\n        for orientation in self.scroll_values:\n\n            if self.filename in self.scroll_values[orientation]:\n\n                self.setScroll(\n\n                    orientation, self.scroll_values[orientation][self.filename]\n\n                )\n\n        # set brightness contrast values\n\n        dialog = BrightnessContrastDialog(\n\n            utils.img_data_to_pil(self.imageData),\n\n            self.onNewBrightnessContrast,\n\n            parent=self,\n\n        )\n\n        brightness, contrast = self.brightnessContrast_values.get(\n\n            self.filename, (None, None)\n\n        )\n\n        if self._config[\"keep_prev_brightness\"] and self.recentFiles:\n\n            brightness, _ = self.brightnessContrast_values.get(\n\n                self.recentFiles[0], (None, None)\n\n            )\n\n        if self._config[\"keep_prev_contrast\"] and self.recentFiles:\n\n            _, contrast = self.brightnessContrast_values.get(\n\n                self.recentFiles[0], (None, None)\n\n            )\n\n        if brightness is not None:\n\n            dialog.slider_brightness.setValue(brightness)\n\n        if contrast is not None:\n\n            dialog.slider_contrast.setValue(contrast)\n\n        self.brightnessContrast_values[self.filename] = (brightness, contrast)\n\n        if brightness is not None or contrast is not None:\n\n            dialog.onNewValue(None)\n\n        self.paintCanvas()\n\n        self.addRecentFile(self.filename)\n\n        self.toggleActions(True)\n\n        self.canvas.setFocus()\n\n        self.status(str(self.tr(\"Loaded %s\")) % osp.basename(str(filename)))\n\n        return True\n",
    "line_range": [
        1579,
        1708
    ],
    "command_specific_fields": {
        "method_name": "loadFile"
    },
    "language": "python",
    "commit": "aca3e64545f55c886760694981df634ae6eb1f32",
    "prompt": ""
}