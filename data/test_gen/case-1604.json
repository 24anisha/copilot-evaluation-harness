{
    "case_id": "case-1604",
    "repo_name": "wkentaro/labelme",
    "file_path": "labelme/app.py",
    "code_snippet": "        if canvas_width_old != canvas_width_new:\n            canvas_scale_factor = canvas_width_new / canvas_width_old\n\n            x_shift = round(pos.x() * canvas_scale_factor) - pos.x()\n            y_shift = round(pos.y() * canvas_scale_factor) - pos.y()\n\n            self.setScroll(\n                Qt.Horizontal,\n                self.scrollBars[Qt.Horizontal].value() + x_shift,\n            )\n            self.setScroll(\n                Qt.Vertical,\n                self.scrollBars[Qt.Vertical].value() + y_shift,\n            )\n\n    def setFitWindow(self, value=True):\n        if value:\n            self.actions.fitWidth.setChecked(False)\n        self.zoomMode = self.FIT_WINDOW if value else self.MANUAL_ZOOM\n        self.adjustScale()\n\n    def setFitWidth(self, value=True):\n        if value:\n            self.actions.fitWindow.setChecked(False)\n        self.zoomMode = self.FIT_WIDTH if value else self.MANUAL_ZOOM\n        self.adjustScale()\n\n    def enableKeepPrevScale(self, enabled):\n        self._config[\"keep_prev_scale\"] = enabled\n        self.actions.keepPrevScale.setChecked(enabled)\n\n    def onNewBrightnessContrast(self, qimage):\n        self.canvas.loadPixmap(QtGui.QPixmap.fromImage(qimage), clear_shapes=False)\n\n    def brightnessContrast(self, value):\n        dialog = BrightnessContrastDialog(\n            utils.img_data_to_pil(self.imageData),\n            self.onNewBrightnessContrast,\n            parent=self,\n        )\n        brightness, contrast = self.brightnessContrast_values.get(\n            self.filename, (None, None)\n        )\n        if brightness is not None:\n            dialog.slider_brightness.setValue(brightness)\n        if contrast is not None:\n            dialog.slider_contrast.setValue(contrast)\n        dialog.exec_()\n\n        brightness = dialog.slider_brightness.value()\n        contrast = dialog.slider_contrast.value()\n        self.brightnessContrast_values[self.filename] = (brightness, contrast)\n\n    def togglePolygons(self, value):\n        flag = value\n        for item in self.labelList:\n            if value is None:\n                flag = item.checkState() == Qt.Unchecked\n            item.setCheckState(Qt.Checked if flag else Qt.Unchecked)\n\n    def loadFile(self, filename=None):\n        \"\"\"Load the specified file, or the last opened file if None.\"\"\"\n        # changing fileListWidget loads file\n        if filename in self.imageList and (\n            self.fileListWidget.currentRow() != self.imageList.index(filename)\n        ):\n            self.fileListWidget.setCurrentRow(self.imageList.index(filename))\n            self.fileListWidget.repaint()\n            return\n\n        self.resetState()\n        self.canvas.setEnabled(False)\n        if filename is None:\n            filename = self.settings.value(\"filename\", \"\")\n        filename = str(filename)\n        if not QtCore.QFile.exists(filename):\n            self.errorMessage(\n                self.tr(\"Error opening file\"),\n                self.tr(\"No such file: <b>%s</b>\") % filename,\n            )\n            return False\n        # assumes same name, but json extension\n        self.status(str(self.tr(\"Loading %s...\")) % osp.basename(str(filename)))\n        label_file = osp.splitext(filename)[0] + \".json\"\n        if self.output_dir:\n            label_file_without_path = osp.basename(label_file)\n            label_file = osp.join(self.output_dir, label_file_without_path)\n        if QtCore.QFile.exists(label_file) and LabelFile.is_label_file(label_file):\n            try:\n                self.labelFile = LabelFile(label_file)\n            except LabelFileError as e:\n                self.errorMessage(\n                    self.tr(\"Error opening file\"),\n                    self.tr(\n                        \"<p><b>%s</b></p>\"\n                        \"<p>Make sure <i>%s</i> is a valid label file.\"\n                    )\n                    % (e, label_file),\n                )\n                self.status(self.tr(\"Error reading %s\") % label_file)\n                return False\n            self.imageData = self.labelFile.imageData\n            self.imagePath = osp.join(\n                osp.dirname(label_file),\n                self.labelFile.imagePath,\n            )\n            self.otherData = self.labelFile.otherData\n        else:\n            self.imageData = LabelFile.load_image_file(filename)\n            if self.imageData:\n                self.imagePath = filename\n            self.labelFile = None\n        image = QtGui.QImage.fromData(self.imageData)\n\n        if image.isNull():\n            formats = [\n                \"*.{}\".format(fmt.data().decode())\n                for fmt in QtGui.QImageReader.supportedImageFormats()\n            ]\n            self.errorMessage(\n                self.tr(\"Error opening file\"),\n                self.tr(\n                    \"<p>Make sure <i>{0}</i> is a valid image file.<br/>\"\n                    \"Supported image formats: {1}</p>\"\n                ).format(filename, \",\".join(formats)),\n            )\n            self.status(self.tr(\"Error reading %s\") % filename)\n            return False\n        self.image = image\n        self.filename = filename\n",
    "line_range": [
        1579,
        1708
    ],
    "command_specific_fields": {
        "method_name": "loadFile"
    },
    "language": "python",
    "commit": "aca3e64545f55c886760694981df634ae6eb1f32",
    "prompt": ""
}