{
    "case_id": "case-0",
    "repo_name": "harelba/q",
    "file_path": "bin/q.py",
    "code_snippet": "        self.source = self.qsql_filename\n        self.source_type = self.table_source_type\n\n        self.db_id = '%s' % self._generate_qsql_only_db_name__temp(self.qtable_name)\n\n        x = 'file:%s?immutable=1' % self.qsql_filename\n        self.db_to_use = Sqlite3DB(self.db_id, x, self.qsql_filename,create_qcatalog=False)\n\n        if forced_db_to_use:\n            xprint(\"Forced qsql to use forced_db: %s\" % forced_db_to_use)\n\n            \n            all_table_names = [(x[0],x[1]) for x in self.db_to_use.execute_and_fetch(\"select content_signature_key,temp_table_name from %s\" % self.db_to_use.QCATALOG_TABLE_NAME).results]\n            csk,t = list(filter(lambda x: x[1] == self.table_name,all_table_names))[0]\n            xprint(\"Copying table %s from db_id %s\" % (t,self.db_id))\n            d = self.db_to_use.get_from_qcatalog_using_table_name(t)\n\n            new_table_name = forced_db_to_use.attach_and_copy_table(self.db_to_use,self.table_name,stop_after_analysis)\n\n            xprint(\"CS\",d['content_signature'])\n            cs = OrderedDict(json.loads(d['content_signature']))\n            forced_db_to_use.add_to_qcatalog_table(new_table_name, cs, d['creation_time'],\n                                    d['source_type'], d['source'])\n\n            self.table_name = new_table_name\n            self.db_id = forced_db_to_use.db_id\n            self.db_to_use = forced_db_to_use\n\n        return",
    "line_range": [
        1991,
        2022
    ],
    "command_specific_fields": {
        "method_name": "choose_db_to_use"
    },
    "language": "python",
    "commit": "03e8b395055747a45f8c12480fd4ed95c2b4e906",
    "prompt": ""
}