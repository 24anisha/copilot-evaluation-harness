{
    "case_id": "case-2221",
    "repo_name": "alibaba/canal",
    "file_path": "client-adapter/launcher/src/main/java/com/alibaba/otter/canal/adapter/launcher/loader/CanalAdapterLoader.java",
    "line_range": [
        50,
        91
    ],
    "command_specific_fields": {
        "method_name": "init"
    },
    "language": "java",
    "commit": "e21e98aa83799c2ece2b7d84dee5f8456dd7f6bf",
    "code_snippet": "    public void init() {\n        loader = ExtensionLoader.getExtensionLoader(OuterAdapter.class);\n\n        for (CanalClientConfig.CanalAdapter canalAdapter : canalClientConfig.getCanalAdapters()) {\n            for (CanalClientConfig.Group group : canalAdapter.getGroups()) {\n                int autoGenId = 0;\n                List<List<OuterAdapter>> canalOuterAdapterGroups = new CopyOnWriteArrayList<>();\n                List<OuterAdapter> canalOuterAdapters = new CopyOnWriteArrayList<>();\n\n                for (OuterAdapterConfig config : group.getOuterAdapters()) {\n                    // \u4fdd\u8bc1\u4e00\u5b9a\u6709key\n                    if (StringUtils.isEmpty(config.getKey())) {\n                        String key = StringUtils.join(\n                            new String[] { Util.AUTO_GENERATED_PREFIX, canalAdapter.getInstance(), group.getGroupId(),\n                                           String.valueOf(autoGenId) },\n                            '-');\n                        //gen keyId\n                        config.setKey(key);\n                    }\n                    autoGenId++;\n                    loadAdapter(config, canalOuterAdapters);\n                }\n                canalOuterAdapterGroups.add(canalOuterAdapters);\n                // canalOuterAdapters \u5b58\u5728\u521d\u59cb\u5316\u5931\u8d25\u7684\u60c5\u51b5\uff0c\u5bfc\u81f4canalOuterAdapters\u7684\u6570\u91cf\uff0c\u53ef\u80fd\u5c0f\u4e8egroup.getOuterAdapters\n                // \u7531\u4e8egroup\u4e0b\u7684 \u6240\u6709OuterAdapter\u5b9e\u4f8b\u90fd\u4f1a\u91cd\u590d\u6d88\u8d39\u540c\u4e00\u6279\u6d88\u606f\uff0c\u56e0\u6b64\u4e0d\u5141\u8bb8\u90e8\u5206adapter\u521d\u59cb\u5316\u6210\u529f\uff0c\u5fc5\u987b\u5168\u90e8\u521d\u59cb\u5316\u6210\u529f\u624d\u5141\u8bb8\u6d88\u8d39\n                if(CollectionUtils.isEmpty(canalOuterAdapters) || canalOuterAdapters.size() != group.getOuterAdapters().size() ){\n                    String msg = String.format(\"instance=%s,groupId=%s Load OuterAdapters is Empty\uff0cpls check rdb.yml\",\n                                canalAdapter.getInstance(),group.getGroupId());\n                        throw new RuntimeException(msg);\n                 }\n                AdapterProcessor adapterProcessor = canalAdapterProcessors.computeIfAbsent(\n                    canalAdapter.getInstance() + \"|\" + StringUtils.trimToEmpty(group.getGroupId()),\n                    f -> new AdapterProcessor(canalClientConfig,\n                        canalAdapter.getInstance(),\n                        group.getGroupId(),\n                        canalOuterAdapterGroups));\n                adapterProcessor.start();\n                logger.info(\"Start adapter for canal-client mq topic: {} succeed\",\n                    canalAdapter.getInstance() + \"-\" + group.getGroupId());\n            }\n        }\n    }\n"
}